name: Test
on: [push, pull_request, workflow_dispatch]
jobs:
  test:
    runs-on: macos-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Test Profiles
        uses: ./
        with:
          profiles: |
            dGVzdC1wcm92aXNpb25pbmctcHJvZmlsZS1zdHJpbmc=
            dGVzdC1wcm92aXNpb25pbmctcHJvZmlsZS1zZWNvbmQtc3RyaW5n

      - name: Verify
        run: |
          ACTUAL=$(cat ~/Library/MobileDevice/Provisioning\ Profiles/*.mobileprovision)
          EXPECTED="test-provisioning-profile-stringtest-provisioning-profile-second-string"

          if [[ "$ACTUAL" = *"$EXPECTED"* ]]; then
            exit 0
          else 
            exit 1
          fi